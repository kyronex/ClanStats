<style>
/* CSS minimal et contextualisé */
#river-race-logs-table th:nth-child(1) { width: 5%; }
#river-race-logs-table th:nth-child(2) { width: 15%; }
#river-race-logs-table th:nth-child(3) { width: 15%; }
#river-race-logs-table th:nth-child(4) { width: 20%; }
#river-race-logs-table th:nth-child(5) { width: 45%; }

#river-race-logs-table .clans-table th:nth-child(1) { width: 5%; }
#river-race-logs-table .clans-table th:nth-child(2) { width: 20%; }
#river-race-logs-table .clans-table th:nth-child(3) { width: 10%; }
#river-race-logs-table .clans-table th:nth-child(4) { width: 5%; }
#river-race-logs-table .clans-table th:nth-child(5) { width: 10%; }
#river-race-logs-table .clans-table th:nth-child(6) { width: 10%; }
#river-race-logs-table .clans-table th:nth-child(7) { width: 15%; }
#river-race-logs-table .clans-table th:nth-child(8) { width: 15%; }
#river-race-logs-table .clans-table th:nth-child(9) { width: 10%; }

#river-race-logs-table .participants-table th:nth-child(1) { width: 25%; }
#river-race-logs-table .participants-table th:nth-child(2) { width: 25%; }
#river-race-logs-table .participants-table th:nth-child(3) { width: 20%; }
#river-race-logs-table .participants-table th:nth-child(4) { width: 15%; }
#river-race-logs-table .participants-table th:nth-child(5) { width: 15%; }
</style>

<div class="container mt-5">
    <table id="river-race-logs-table" class="table table-striped">
        <thead>
            <tr>
                <th colspan="5">Nombre de résultat : {{ riverRaceLogs|length }}</th>
            </tr>
            <tr>
                <th></th>
                <th>Season Id</th>
                <th>Section Index</th>
                <th>Created Date</th>
                <th>
                    <button 
                        class="btn btn-sm btn-primary"
                        data-action="historiqueClanWar#call" 
                        data-clan-tag="{{ tag }}" 
                        title="Calcule l'historique de toutes les guerres sélectionnées">
                        Historique
                    </button>
                </th>
            </tr>
        </thead>
        <tbody>
            {% for riverRaceLog in riverRaceLogs %}
                <tr>
                    <td>
                        <button 
                            class="btn btn-sm btn-outline-secondary"
                            data-action="riverRaceLog#togglerShow" 
                            data-target-toggler="{{ riverRaceLog.seasonId }}_{{ riverRaceLog.sectionIndex }}">
                            +
                        </button>
                    </td>
                    <td>{{ riverRaceLog.seasonId }}</td>
                    <td>{{ riverRaceLog.sectionIndex }}</td>
                    <td>{{ riverRaceLog.createdDate }}</td>
                    <td>
                        <input 
                            type="checkbox" 
                            id="HC_{{ riverRaceLog.seasonId }}_{{ riverRaceLog.sectionIndex }}" 
                            name="historiqueCheckbox" 
                            value="{{ riverRaceLog.seasonId }}_{{ riverRaceLog.sectionIndex }}" 
                            title="Sélectionne cette guerre dans l'historique" 
                            checked>
                    </td>
                </tr>
                <tr id="{{ riverRaceLog.seasonId }}_{{ riverRaceLog.sectionIndex }}" hidden>
                    <td colspan="5">
                        <table class="table table-sm clans-table">
                            <thead>
                                <tr>
                                    <th></th>
                                    <th>Name</th>
                                    <th>Tag</th>
                                    <th>Rank</th>
                                    <th>Trophy Change</th>
                                    <th>Fame</th>
                                    <th>Clan Score</th>
                                    <th>Finish Time</th>
                                    <th>Badge Id</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for clan in riverRaceLog.clans %}
                                    <tr>
                                        <td>
                                            <button 
                                                class="btn btn-sm btn-outline-secondary"
                                                data-action="clanRiverRaceLog#togglerShow" 
                                                data-target-toggler="{{ riverRaceLog.seasonId }}_{{ riverRaceLog.sectionIndex }}_{{ clan.tag }}">
                                                +
                                            </button>
                                        </td>
                                        <td>{{ clan.name }}</td>
                                        <td>{{ clan.tag }}</td>
                                        <td>{{ clan.rank }}</td>
                                        <td>{{ clan.trophyChange }}</td>
                                        <td>{{ clan.fame|number_format }}</td>
                                        <td>{{ clan.clanScore|number_format }}</td>
                                        <td>{{ clan.finishTime }}</td>
                                        <td>{{ clan.badgeId }}</td>
                                    </tr>    
                                    <tr id="{{ riverRaceLog.seasonId }}_{{ riverRaceLog.sectionIndex }}_{{ clan.tag }}" hidden>
                                        <td colspan="9">
                                            <table class="table table-sm participants-table">
                                                <thead>
                                                    <tr>
                                                        <th>Name</th>
                                                        <th>Tag</th>
                                                        <th>Fame</th>
                                                        <th>Boat Attacks</th>
                                                        <th>Decks Used</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    {% for participant in clan.participants %}
                                                        <tr id="{{ riverRaceLog.seasonId }}_{{ riverRaceLog.sectionIndex }}_{{ clan.tag }}_{{ participant.tag }}">
                                                            <td>{{ participant.name }}</td>
                                                            <td>{{ participant.tag }}</td>
                                                            <td>{{ participant.fame|number_format }}</td>
                                                            <td>{{ participant.boatAttacks }}</td>
                                                            <td>{{ participant.decksUsed }}</td>
                                                        </tr> 
                                                    {% endfor %}
                                                </tbody>
                                            </table>
                                        </td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
